jQuery(document).ready(function(a){function b(a){if(a.loading)return a.text;var b='<div class="clearfix"><div class="col-sm-6">'+a.name+"</div></div>";return b}function c(a){return a.name||a.text}function d(){var a=getCurrentRegionHierarchy(),b=a.id;null!=b&&e(b)}function e(b){a("#hierarchyId").text(b),a("#hierarchyId").val(b),a("#form-filter-setting").trigger("submit")}function f(a){return a%1===0}function g(b,c,d){var e="btn-warning btn-xs";a("#state-app span").removeClass(e),a("#state-integra span").removeClass(e),a("#state span").removeClass(e),(void 0===d||d)&&a("#stateToggle").bootstrapToggle("off"),a("#status").attr("value")===b||0==b?(a("#status").attr("value","0"),j()):("state"!=c?a("#"+c+" span").addClass(e):(void 0===d||d)&&a("#stateToggle").bootstrapToggle("on"),a("#status").attr("value",b),i(b,c))}function h(){if(localStorage&&localStorage.getItem("state")){var a=JSON.parse(localStorage.getItem("state"));g(a.id,a.name)}}function i(a,b){var c={};c.id=a,c.name=b,localStorage.setItem("state",JSON.stringify(c))}function j(){localStorage&&localStorage.getItem("state")&&localStorage.removeItem("state")}var k,l=a('input[name="trans-date-picker-FormatSec"]').val(),m=getToggleChildrenBool(),n=a("#translate-select").val(),o=a("#translate-list-zone").val(),p=a("#translate-partition").val();a("#controlList").select2(),a("#stateToggle").bootstrapToggle(),a(document).on("tree-toggle-recvd",function(b,c){m="1"==c,a("#form-filter-setting").submit()}),a(function(){a('[data-toggle2="tooltip"]').tooltip()});var q=a("#idSpinner").hide();a(document).on("tree-selected",function(){d()}),a("#controlList").select2({minimumInputLength:1,ajax:{url:function(a){return encodeURI("/control/findbyname/?name="+a.term)},dataType:"json",delay:250,processResults:function(a){return{results:a}},cache:!0},escapeMarkup:function(a){return a},templateResult:b,templateSelection:c}),a("#controlList").on("select2:select",function(){a("#btnFilter").attr("disabled",!1)}),a("#btnCollapse").click(function(){a("#btnCollapse>i").toggleClass("fa-caret-down fa-caret-right")}),a("#controlList").on("change",function(){var b=a(this).val();b&&f(b)?a.get("/control/"+b+"/jstructure",function(b){k=b,a("#integraPartition").empty(),a("#integraPartition").attr("disabled",!1),a.each(b,function(b,c){a("#integraPartition").append('<option value="'+c.id+'">'+c.text+" </option>")})},"json"):(a("#integraPartition").empty(),a("#integraPartition").append(a("<option></option>").attr("value","").text(p)),a("#integraZone").empty(),a("#integraZone").append(a("<option></option>").attr("value","").attr("selected","selected").text(o)),a("#integraPartition").attr("disabled",!0),a("#integraZone").attr("disabled",!0))}),a("#integraPartition").on("change",function(b){for(var c=b.target.value,d=0;d<k.length;d++){var e=k[d];e.id==c&&(a("#integraZone").empty(),a("#integraZone").attr("disabled",!1),a("#integraZone").append('<option value="0">'+n+" </option>"),a.each(e.partitionList,function(b,c){a("#integraZone").append('<option value="'+c.id+'">'+c.text+" </option>")})),0==c&&(a("#integraZone").empty(),a("#integraZone").attr("disabled",!0))}}),a("#btn-filter-clear").click(function(){a("#controlList").val("").trigger("change"),a("#access option:first").attr("selected","selected"),a("#surname").val(""),a("#email").val(""),a("#phone").val(""),g(0,""),a("#form-filter-setting").submit(),a("#surname").focus()}),a("#refreshDateBtn").click(function(){a("#form-filter-setting").submit()}),a("#form-filter-setting").on("submit",function(){q.show();var b=moment().format(l);return a.post(a(this).prop("action"),{_token:a(this).find("input[name=_token]").val(),hierarchyId:a("#hierarchyId").val(),showArchive:"0"===a("#showArchive").val()?!1:!0,surname:a("#surname").val(),email:a("#email").val(),phone:a("#phone").val(),status:a("#status").val(),controlList:a("#controlList").val(),integraPartition:a("#integraPartition").val(),integraZone:a("#integraZone").val(),access:a("#input-access").val(),withChildren:m?"true":"false"},function(c){a("#refreshDateTxt").html(b);var d={1:"",2:"outlined",3:"blink"};a("#userTable").empty(),a(c).each(function(b,c){a("#userTable").append('<tr data-inpanel="'+(1==c.status[2].status?"1":"0")+'"><td><a href="/users/'+c.id+'/edit/"> '+c.name+" </a></td><td> "+c.email+" </td><td> "+c.telephone+'                                               </td><td><a class="diodes" href="/users/'+c.id+'/edit/#user-2"><div class="diode yellow '+d[c.status[1].status]+'"></div></a>                                               </td><td><a class="diodes" href="/users/'+c.id+'/edit/#user-3"><div class="diode green '+d[c.status[2].status]+'"></div></a>                                               </td><td class="actionColumn"> '+decodeURIComponent(escape(atob(c.action)))+" </td><td></td></tr>")}),q.hide()},"json").fail(function(a){0!==a.readyState&&(window.location.href="/logout")}),!1}),h(),a("#state-app").css("cursor","pointer"),a("#state-integra").css("cursor","pointer"),a("#state").css("cursor","pointer"),a("#state-app").click(function(){g("2","state-app"),a("#form-filter-setting").submit()}),a("#state-integra").click(function(){g("3","state-integra"),a("#form-filter-setting").submit()}),a("#state").click(function(){g("1","state",!1),a("#form-filter-setting").submit()}),a("#confirm-delete").on("show.bs.modal",function(b){a("#deletUser").empty(),a(b.relatedTarget).parents("tr").data("inpanel")>0?a("#remove-from-panel").show():a("#remove-from-panel").hide(),a("#remove-from-panel-lnk").val(a(b.relatedTarget).data("value")),a("#remove-from-panel-chk").prop("checked",a(b.relatedTarget).parents("tr").data("inpanel")>0),a("#deletUser").append(a(b.relatedTarget).data("name")),a(this).find(".btn-ok").attr("href",a("#remove-from-panel-lnk").val().replace("__wp__",a("#remove-from-panel-chk").prop("checked")?"true":"false"))}),a("#remove-from-panel-chk").change(function(b){var c=a("#remove-from-panel-lnk").val().replace("__wp__",a("#remove-from-panel-chk").prop("checked")?"true":"false");a(b.target).parents("div").find(".btn-ok").attr("href",c)}),d()});