function EventDialog(a){this.$dialog=void 0,this.dialogName=a.name,a.queue&&(this.$q=a.queue,$(document).on("dashboard-event-registered",$.proxy(function(a,b){if(this.handleEvent(a),this.$dialog){var c=this.$dialog.options.data.evnt;if(void 0===c)return;c.attributes.systemId==b.attributes.systemId&&c.attributes.idPartition==b.attributes.idPartition&&$("#ev-clear-alarm-chk").removeAttr("checked")}},this)),$(document).on("dashboard-event-removed",$.proxy(function(a,b){this.$dialog&&b.id===this.$dialog.options.data.evnt.id&&(this.$dialog.options.data.takeover||($("#comment-event-btn").removeClass("hidden"),this.$dialog.close()))},this))),this.hideSleepOption=a.hideSleepOption||!1,this.closable=a.closable||!1;var b={Comment:$('input[name="trans-comment"]').val()||"trans-comment",CommentNext:$('input[name="trans-comment-next"]').val(),CommentClose:$('input[name="trans-comment-close"]').val(),CommentCloseHandling:$('input[name="trans-comment-close-handling"]').val(),CommentConfirm:$('input[name="trans-comment-confirm"]').val(),CommentConfirmYes:$('input[name="trans-comment-confirm-yes"]').val(),CommentConfirmNo:$('input[name="trans-comment-confirm-no"]').val(),CommentDefaultMessage:$('input[name="trans-comment-default"]').val(),CommentAdd:$('input[name="trans-comment-add"]').val(),CommentDelay:$('input[name="trans-comment-delay"]').val(),CommentDate:$('input[name="trans-comment-date"]').val(),CommentOperator:$('input[name="trans-comment-operator"]').val(),CommentDescr:$('input[name="trans-comment-descr"]').val(),CommentDescrAdd:$('input[name="trans-comment-descr-add"]').val(),CommentClearAlarm:$('input[name="trans-comment-clear-alarm"]').val(),CommentDisarm:$('input[name="trans-comment-disarm"]').val()},c=function(a,c,d){var e='<div style="max-height:65vh;overflow:auto"><table class="table table-bordered table-condensed table-striped">';return a&&(e+='<tr><th class="col-md-4">'+b.CommentDate+'</th><th class="col-md-6">'+b.CommentDescr+'</th><th class="col-md-2">'+b.CommentOperator+"</th></tr>",$.each(a,function(a,b){e+='<tr><td class="col-md-4">'+b.date+'</td><td class="col-md-6"><div style="max-height:80px;max-width:280px;overflow:auto">'+b.comment+'</div></td><td class="col-md-2"><a target="blank" href="../users/'+b.idUser+'/edit">'+b.userName+"</a></td></tr>"})),e+='<tr><td class="col-md-'+(a?4:2)+'" style="text-align:right;vertical-align:top !important;">'+b.CommentDescrAdd+"</td><td "+(a?'colspan="2" ':"")+'class="col-md-'+(a?8:10)+'"><textarea id="ev-comment" maxlength="2500" style="resize: none;width:100%"></textarea><br><div  id="ev-clear-alarm" style="display:'+(c?"block":"none")+';" ><input id="ev-clear-alarm-chk" type="checkbox"'+(d?' checked="checked"':"")+"> "+b.CommentClearAlarm+'</input>&nbsp;&nbsp;<input id="ev-disarm-chk" type="checkbox"> '+b.CommentDisarm+"</div></td></tr>",e+="</table></div>"},d=function(a){return localStorage?localStorage.getItem(a):null},e=function(a,b){localStorage.setItem(a,b)},f=function(a){var b=a.message+"<div class='pull-right'>"+a.date+"</div><br>"+(a.attributes.detail?a.attributes.detail:"<br/>");return a.attributes.idZone?b+="<div class='pull-right'><input class='dialog-map-autolocate' type='checkbox' "+("true"===d("ev-comment-autozoom")?"checked":"")+"></input><div class='btn dialog-map-locate' data-layercode='INT-ZON' data-attrid='"+a.attributes.idZone+"'><i class='fa fa-map-o'></i></div></div>":a.attributes.idPartition&&(b+="<div class='pull-right'><input class='dialog-map-autolocate' type='checkbox' "+("true"===d("ev-comment-autozoom")?"checked":"")+"></input><div class='btn dialog-map-locate' data-layercode='INT-PART' data-attrid='"+a.attributes.idPartition+"'><i class='fa fa-map-o'></i></div></div>"),b};this.zoomToEvent=function(a){a.attributes.idZone?this.zoomTo("INT-ZON",a.attributes.idZone):a.attributes.idPartition&&this.zoomTo("INT-PART",a.attributes.idPartition)};var g=function(a,b,d){return'<a target="blank" href="../control/structure/'+b.attributes.systemId+'/">'+b.attributes.systemName+"</a><br>\n\n"+(d?c(b.attributes.comments,!a.hideSleepOption&&i(b.attributes)&&b.attributes.hasOwnProperty("idPartition"),1==h(a.$q,b.attributes.systemId,b.attributes.idPartition)):"")},h=function(a,b,c){return void 0===a?0:$.grep(a.eventQueue,function(a){return a.attributes.systemId==b&&a.attributes.idPartition==c?a:void 0}).length+$.grep(a.myEventQueue,function(a){return a.attributes.systemId==b&&a.attributes.idPartition==c?a:void 0}).length},i=function(a){return 1==a["class"]||0==a["class"]};this.zoomTo=function(a,b){$('a.zoomTo[data-layercode="'+a+'"][data-attrid="'+b+'"]').trigger("click")},this.enableComment=function(a,b){var c=b.evnt;myEvent=b.src,a.options.data.takeover=!0;var d=a.getButton("control-event-btn");a.setMessage(g(this,c,!0)),d.addClass("hidden"),a.getButton("comment-event-btn").removeClass("hidden"),a.getButton("sleep-event-btn").removeClass("hidden"),a.getButton("comment-event-btn").enable(),a.getButton("sleep-event-btn").enable(),a.getModalBody().find("#ev-comment").focus(),this.$q.removeEventFromQueue(a.options.data.evnt.id);var e=this.$q.addEventToMyQueue(c);e.takeover=!0,a.options.data=e,this.$q.reset(!1),this.eventTakeOver(b)},this.addComment=function(a){var b=a.getModalBody().find("#ev-comment").val();if(b)if(b=b.replace(/(\r\n|\n|\r)/gm,""),b&&b.length>0){this.addEventComment(a.options.data,b);var c;$("#ev-disarm-chk").is(":visible")&&$("#ev-disarm-chk").is(":checked")&&(c={type:"Action","cmd-id":Date.now().toString(),action:"disarm",layer:"INT-PART",confirm:!1},c.id=a.options.data.evnt.attributes.idPartition,WS.wsSendMessage(JSON.stringify(c))),$("#ev-clear-alarm-chk").is(":visible")&&$("#ev-clear-alarm-chk").is(":checked")&&(c={type:"Action","cmd-id":Date.now().toString(),action:"clearAlarm",layer:"INT-PART",confirm:!1},c.id=a.options.data.evnt.attributes.idPartition,WS.wsSendMessage(JSON.stringify(c))),a.close(),this.$q&&this.$q.removeEventFromMyQueue(a.options.data.evnt.id)}else a.getModalBody().find("#ev-comment").focus()},this.nextComment=function(){this.showEventDialog(this.$q.next())},this.prevComment=function(){this.showEventDialog(this.$q.prev())},this.showMyEventDialog=function(){this.$q.reset(!0),this.showEventDialog()},this.showAllEventDialog=function(){this.$q.reset(!1),this.showEventDialog()},this.showCommentEventDialog=function(a){this.showEventDialog(a?{src:!0,evnt:a}:void 0)},this.showEventDialog=function(a){var c=a?a:this.$q.get();if(void 0!==c){var d,h=c.evnt,i=c.src;switch(h.attributes["class"]){case 0:case 1:d=BootstrapDialog.TYPE_DANGER;break;case 5:d=BootstrapDialog.TYPE_WARNING;break;default:d=null}d||(d=BootstrapDialog.TYPE_INFO),this.$dialog?(this.$dialog.options.data=c,this.$dialog.setType(d),this.$dialog.setTitle(f(h)),this.$dialog.setMessage(g(this,h,h.attributes.comments||i))):(this.$dialog=BootstrapDialog.show({id:this.dialogName,animate:!0,type:d,closable:this.closable,css:"eventDialogMessage",data:c,draggable:!0,buttons:[{id:"close-event-btn",cssClass:"pull-left",label:this.hideSleepOption?b.CommentClose:b.CommentCloseHandling,action:$.proxy(function(){this.hideSleepOption?this.$dialog.close():BootstrapDialog.show({animate:!1,type:BootstrapDialog.TYPE_DANGER,title:b.CommentClose,message:b.CommentConfirm,closable:!1,buttons:[{label:b.CommentConfirmYes,action:$.proxy(function(a){var c=this.$dialog.options.data;this.eventTakeOver(c),this.addEventComment(c,b.CommentDefaultMessage),c.src?this.$q.removeEventFromMyQueue(c.evnt.id):this.$q.removeEventFromQueue(c.evnt.id),$("#comment-event-btn").removeClass("hidden"),this.$dialog.close(),a.close()},this)},{label:b.CommentConfirmNo,action:function(a){a.close()}}]})},this)},{id:"prev-event-btn",label:"<",cssClass:"btn-default pull-left"+(void 0==this.$q?" hidden":""),action:$.proxy(function(a){this.prevComment(a)},this)},{id:"next-event-btn",label:">",cssClass:"btn-default pull-left"+(void 0==this.$q?" hidden":""),action:$.proxy(function(a){this.nextComment(a)},this)},{id:"control-event-btn",label:b.Comment,cssClass:"btn-info"+(i?" hidden":""),action:$.proxy(function(a){this.enableComment(a,this.$q.get())},this)},{id:"comment-event-btn",label:b.CommentAdd,cssClass:i?"btn-info":"btn-info hidden",action:$.proxy(function(a){this.addComment(a)},this)},{id:"sleep-event-btn",label:b.CommentDelay,cssClass:i&&!this.hideSleepOption?"":"hidden",action:function(a){a.close()}}],title:f(h),message:g(this,h,h.attributes.comments||i),onhidden:$.proxy(function(){var a=this.$dialog.options.data;if(this.$dialog=void 0,this.$q){var b=this.$q.next(!0);b&&b.evnt.id!=a.id&&this.showEventDialog(b)}},this)}),this.$dialog.getModal().on("keyup",{dialog:this.$dialog,obj:this},function(a){var b=a.data.dialog,c=a.data.obj;if(13==a.which){var d=b.getButton("control-event-btn"),e=b.getButton("comment-event-btn"),f=!(d.prop("disabled")||d.hasClass("hidden")),g=!(e.prop("disabled")||e.hasClass("hidden"));f&&d.focus().trigger("click"),g&&e.focus().trigger("click")}else a.ctrlKey&&(188==a.which?c.prevComment(b):190==a.which&&c.nextComment(b))}),this.$dialog.getModal().on("mouseup",{dialogObj:this},function(a){var b=a.data.dialogObj;b.position=b.$dialog.$modalDialog.position(),$("div.bootstrap-dialog-resetpos-button").css({color:b.position.left==b.position.top&&0==b.position.top?"black":"red"})})),this.$dialog.getModal().on("click","div.bootstrap-dialog-resetpos-button",$.proxy(function(){this.$dialog.getModalDialog().css({left:0,top:0}),$("div.bootstrap-dialog-resetpos-button").css({color:"black"})},this)),this.$dialog.getModal().on("click","div.dialog-map-locate",$.proxy(function(a){var b=$(a.currentTarget);this.zoomTo(b.data("layercode"),b.data("attrid"))},this)),this.$dialog.getModal().on("click","input.dialog-map-autolocate",$.proxy(function(){e("ev-comment-autozoom",$(".dialog-map-autolocate").is(":checked"))},this));var j=this.$dialog.getButton("next-event-btn");j.toggleEnable(void 0!=this.$q),this.$dialog.isOpened()||this.$dialog.open(),i?(this.$dialog.getButton("control-event-btn").addClass("hidden"),this.$dialog.getButton("sleep-event-btn").removeClass("hidden"),this.$dialog.getButton("comment-event-btn").removeClass("hidden")):(this.$dialog.getButton("control-event-btn").removeClass("hidden"),this.$dialog.getButton("sleep-event-btn").addClass("hidden"),this.$dialog.getButton("comment-event-btn").addClass("hidden")),this.$dialog.getModal().on("shown.bs.modal",{dialog:this.$dialog,obj:this},function(a){var b=a.data.dialog,c=a.data.obj;b.getModalBody().find("#ev-comment").length>0&&b.getModalBody().find("#ev-comment").is(":visible")&&b.getModalBody().find("#ev-comment").focus(),$('<div class="bootstrap-dialog-resetpos-button"><i class="fa fa-thumb-tack"></i></div>').insertAfter($(".bootstrap-dialog-close-button")),c.position&&(b.getModalDialog().css(c.position),$("div.bootstrap-dialog-resetpos-button").css({color:c.position.left==c.position.top&&0==c.position.top?"black":"red"})),$(".dialog-map-autolocate").length>0&&$(".dialog-map-autolocate").is(":checked")&&c.zoomToEvent(h)}),$(".dialog-map-autolocate").length>0&&$(".dialog-map-autolocate").is(":checked")&&this.zoomToEvent(h),i&&(this.$dialog.options.data.takeover=!0)}},this.eventTakeOver=function(a){var b=a.evnt;WS.wsSendMessage(JSON.stringify({type:"Action",action:"ev-take-over",layer:"INT-INT","cmd-id":Date.now().toString(),id:b.id,attributes:{hierarchyQuery:b.hierarchyQuery,date:b.date}}))},this.addEventComment=function(a,b){$.post("/event/comments",{_token:$("input[name=_token]").val(),id:a.evnt.id,comment:b},function(){$(document).trigger("ev-comment-added",a.evnt.id)}).fail(function(a){0!==a.readyState&&(window.location.href="/logout")})},this.handleEvent=function(){void 0!==this.$dialog&&this.$dialog.opened||this.showAllEventDialog()}}!function(a,b){"use strict";"undefined"!=typeof module&&module.exports?module.exports=b(require("jquery"),require("bootstrap")):"function"==typeof define&&define.amd?define("bootstrap-dialog",["jquery","bootstrap"],function(a){return b(a)}):a.BootstrapDialog=b(a.jQuery)}(this,function(a){"use strict";var b=a.fn.modal.Constructor,c=function(a,c){b.call(this,a,c)};c.getModalVersion=function(){var b=null;return b="undefined"==typeof a.fn.modal.Constructor.VERSION?"v3.1":/3\.2\.\d+/.test(a.fn.modal.Constructor.VERSION)?"v3.2":/3\.3\.[1,2]/.test(a.fn.modal.Constructor.VERSION)?"v3.3":"v3.3.4"},c.ORIGINAL_BODY_PADDING=parseInt(a("body").css("padding-right")||0,10),c.METHODS_TO_OVERRIDE={},c.METHODS_TO_OVERRIDE["v3.1"]={},c.METHODS_TO_OVERRIDE["v3.2"]={hide:function(b){if(b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()){this.isShown=!1;var c=this.getGlobalOpenedDialogs();0===c.length&&this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()}}},c.METHODS_TO_OVERRIDE["v3.3"]={setScrollbar:function(){var a=c.ORIGINAL_BODY_PADDING;this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},resetScrollbar:function(){var a=this.getGlobalOpenedDialogs();0===a.length&&this.$body.css("padding-right",c.ORIGINAL_BODY_PADDING)},hideModal:function(){this.$element.hide(),this.backdrop(a.proxy(function(){var a=this.getGlobalOpenedDialogs();0===a.length&&this.$body.removeClass("modal-open"),this.resetAdjustments(),this.resetScrollbar(),this.$element.trigger("hidden.bs.modal")},this))}},c.METHODS_TO_OVERRIDE["v3.3.4"]=a.extend({},c.METHODS_TO_OVERRIDE["v3.3"]),c.prototype={constructor:c,getGlobalOpenedDialogs:function(){var b=[];return a.each(d.dialogs,function(a,c){c.isRealized()&&c.isOpened()&&b.push(c)}),b}},c.prototype=a.extend(c.prototype,b.prototype,c.METHODS_TO_OVERRIDE[c.getModalVersion()]);var d=function(b){this.defaultOptions=a.extend(!0,{id:d.newGuid(),buttons:[],data:{},onshow:null,onshown:null,onhide:null,onhidden:null},d.defaultOptions),this.indexedButtons={},this.registeredButtonHotkeys={},this.draggableData={isMouseDown:!1,mouseOffset:{}},this.realized=!1,this.opened=!1,this.initOptions(b),this.holdThisInstance()};return d.BootstrapDialogModal=c,d.NAMESPACE="bootstrap-dialog",d.TYPE_DEFAULT="type-default",d.TYPE_INFO="type-info",d.TYPE_PRIMARY="type-primary",d.TYPE_SUCCESS="type-success",d.TYPE_WARNING="type-warning",d.TYPE_DANGER="type-danger",d.DEFAULT_TEXTS={},d.DEFAULT_TEXTS[d.TYPE_DEFAULT]="Information",d.DEFAULT_TEXTS[d.TYPE_INFO]="Information",d.DEFAULT_TEXTS[d.TYPE_PRIMARY]="Information",d.DEFAULT_TEXTS[d.TYPE_SUCCESS]="Success",d.DEFAULT_TEXTS[d.TYPE_WARNING]="Warning",d.DEFAULT_TEXTS[d.TYPE_DANGER]="Danger",d.DEFAULT_TEXTS.OK="OK",d.DEFAULT_TEXTS.CANCEL="Cancel",d.DEFAULT_TEXTS.CONFIRM="Confirmation",d.SIZE_NORMAL="size-normal",d.SIZE_SMALL="size-small",d.SIZE_WIDE="size-wide",d.SIZE_LARGE="size-large",d.BUTTON_SIZES={},d.BUTTON_SIZES[d.SIZE_NORMAL]="",d.BUTTON_SIZES[d.SIZE_SMALL]="",d.BUTTON_SIZES[d.SIZE_WIDE]="",d.BUTTON_SIZES[d.SIZE_LARGE]="btn-lg",d.ICON_SPINNER="glyphicon glyphicon-asterisk",d.BUTTONS_ORDER_CANCEL_OK="btns-order-cancel-ok",d.BUTTONS_ORDER_OK_CANCEL="btns-order-ok-cancel",d.defaultOptions={type:d.TYPE_PRIMARY,size:d.SIZE_NORMAL,cssClass:"",title:null,message:null,nl2br:!0,closable:!0,closeByBackdrop:!0,closeByKeyboard:!0,closeIcon:"&#215;",spinicon:d.ICON_SPINNER,autodestroy:!0,draggable:!1,animate:!0,description:"",tabindex:-1,btnsOrder:d.BUTTONS_ORDER_CANCEL_OK},d.configDefaultOptions=function(b){d.defaultOptions=a.extend(!0,d.defaultOptions,b)},d.dialogs={},d.openAll=function(){a.each(d.dialogs,function(a,b){b.open()})},d.closeAll=function(){a.each(d.dialogs,function(a,b){b.close()})},d.getDialog=function(a){var b=null;return"undefined"!=typeof d.dialogs[a]&&(b=d.dialogs[a]),b},d.setDialog=function(a){return d.dialogs[a.getId()]=a,a},d.addDialog=function(a){return d.setDialog(a)},d.moveFocus=function(){var b=null;a.each(d.dialogs,function(a,c){c.isRealized()&&c.isOpened()&&(b=c)}),null!==b&&b.getModal().focus()},d.METHODS_TO_OVERRIDE={},d.METHODS_TO_OVERRIDE["v3.1"]={handleModalBackdropEvent:function(){return this.getModal().on("click",{dialog:this},function(a){a.target===this&&a.data.dialog.isClosable()&&a.data.dialog.canCloseByBackdrop()&&a.data.dialog.close()}),this},updateZIndex:function(){if(this.isOpened()){var b=1040,c=1050,e=0;a.each(d.dialogs,function(a,b){b.isRealized()&&b.isOpened()&&e++});var f=this.getModal(),g=f.data("bs.modal").$backdrop;f.css("z-index",c+20*(e-1)),g.css("z-index",b+20*(e-1))}return this},open:function(){return!this.isRealized()&&this.realize(),this.getModal().modal("show"),this.updateZIndex(),this}},d.METHODS_TO_OVERRIDE["v3.2"]={handleModalBackdropEvent:d.METHODS_TO_OVERRIDE["v3.1"].handleModalBackdropEvent,updateZIndex:d.METHODS_TO_OVERRIDE["v3.1"].updateZIndex,open:d.METHODS_TO_OVERRIDE["v3.1"].open},d.METHODS_TO_OVERRIDE["v3.3"]={},d.METHODS_TO_OVERRIDE["v3.3.4"]=a.extend({},d.METHODS_TO_OVERRIDE["v3.1"]),d.prototype={constructor:d,initOptions:function(b){return this.options=a.extend(!0,this.defaultOptions,b),this},holdThisInstance:function(){return d.addDialog(this),this},initModalStuff:function(){return this.setModal(this.createModal()).setModalDialog(this.createModalDialog()).setModalContent(this.createModalContent()).setModalHeader(this.createModalHeader()).setModalBody(this.createModalBody()).setModalFooter(this.createModalFooter()),this.getModal().append(this.getModalDialog()),this.getModalDialog().append(this.getModalContent()),this.getModalContent().append(this.getModalHeader()).append(this.getModalBody()).append(this.getModalFooter()),this},createModal:function(){var b=a('<div class="modal" role="dialog" aria-hidden="true"></div>');return b.prop("id",this.getId()),b.attr("aria-labelledby",this.getId()+"_title"),b},getModal:function(){return this.$modal},setModal:function(a){return this.$modal=a,this},createModalDialog:function(){return a('<div class="modal-dialog"></div>')},getModalDialog:function(){return this.$modalDialog},setModalDialog:function(a){return this.$modalDialog=a,this},createModalContent:function(){return a('<div class="modal-content"></div>')},getModalContent:function(){return this.$modalContent},setModalContent:function(a){return this.$modalContent=a,this},createModalHeader:function(){return a('<div class="modal-header"></div>')},getModalHeader:function(){return this.$modalHeader},setModalHeader:function(a){return this.$modalHeader=a,this},createModalBody:function(){return a('<div class="modal-body"></div>')},getModalBody:function(){return this.$modalBody},setModalBody:function(a){return this.$modalBody=a,this},createModalFooter:function(){return a('<div class="modal-footer"></div>')},getModalFooter:function(){return this.$modalFooter},setModalFooter:function(a){return this.$modalFooter=a,this},createDynamicContent:function(a){var b=null;return b="function"==typeof a?a.call(a,this):a,"string"==typeof b&&(b=this.formatStringContent(b)),b},formatStringContent:function(a){return this.options.nl2br?a.replace(/\r\n/g,"<br />").replace(/[\r\n]/g,"<br />"):a},setData:function(a,b){return this.options.data[a]=b,this},getData:function(a){return this.options.data[a]},setId:function(a){return this.options.id=a,this},getId:function(){return this.options.id},getType:function(){return this.options.type},setType:function(a){return this.options.type=a,this.updateType(),this},updateType:function(){if(this.isRealized()){var a=[d.TYPE_DEFAULT,d.TYPE_INFO,d.TYPE_PRIMARY,d.TYPE_SUCCESS,d.TYPE_WARNING,d.TYPE_DANGER];this.getModal().removeClass(a.join(" ")).addClass(this.getType())}return this},getSize:function(){return this.options.size},setSize:function(a){return this.options.size=a,this.updateSize(),this},updateSize:function(){if(this.isRealized()){var b=this;this.getModal().removeClass(d.SIZE_NORMAL).removeClass(d.SIZE_SMALL).removeClass(d.SIZE_WIDE).removeClass(d.SIZE_LARGE),this.getModal().addClass(this.getSize()),this.getModalDialog().removeClass("modal-sm"),this.getSize()===d.SIZE_SMALL&&this.getModalDialog().addClass("modal-sm"),this.getModalDialog().removeClass("modal-lg"),this.getSize()===d.SIZE_WIDE&&this.getModalDialog().addClass("modal-lg"),a.each(this.options.buttons,function(c,d){var e=b.getButton(d.id),f=["btn-lg","btn-sm","btn-xs"],g=!1;if("string"==typeof d.cssClass){var h=d.cssClass.split(" ");a.each(h,function(b,c){-1!==a.inArray(c,f)&&(g=!0)})}g||(e.removeClass(f.join(" ")),e.addClass(b.getButtonSize()))})}return this},getCssClass:function(){return this.options.cssClass},setCssClass:function(a){return this.options.cssClass=a,this},getTitle:function(){return this.options.title},setTitle:function(a){return this.options.title=a,this.updateTitle(),this},updateTitle:function(){if(this.isRealized()){var a=null!==this.getTitle()?this.createDynamicContent(this.getTitle()):this.getDefaultText();this.getModalHeader().find("."+this.getNamespace("title")).html("").append(a).prop("id",this.getId()+"_title")}return this},getMessage:function(){return this.options.message},setMessage:function(a){return this.options.message=a,this.updateMessage(),this},updateMessage:function(){if(this.isRealized()){var a=this.createDynamicContent(this.getMessage());this.getModalBody().find("."+this.getNamespace("message")).html("").append(a)}return this},isClosable:function(){return this.options.closable},setClosable:function(a){return this.options.closable=a,this.updateClosable(),this},setCloseByBackdrop:function(a){return this.options.closeByBackdrop=a,this},canCloseByBackdrop:function(){return this.options.closeByBackdrop},setCloseByKeyboard:function(a){return this.options.closeByKeyboard=a,this},canCloseByKeyboard:function(){return this.options.closeByKeyboard},isAnimate:function(){return this.options.animate},setAnimate:function(a){return this.options.animate=a,this},updateAnimate:function(){return this.isRealized()&&this.getModal().toggleClass("fade",this.isAnimate()),this},getSpinicon:function(){return this.options.spinicon},setSpinicon:function(a){return this.options.spinicon=a,this},addButton:function(a){return this.options.buttons.push(a),this},addButtons:function(b){var c=this;return a.each(b,function(a,b){c.addButton(b)}),this},getButtons:function(){return this.options.buttons},setButtons:function(a){return this.options.buttons=a,this.updateButtons(),this},getButton:function(a){return"undefined"!=typeof this.indexedButtons[a]?this.indexedButtons[a]:null},getButtonSize:function(){return"undefined"!=typeof d.BUTTON_SIZES[this.getSize()]?d.BUTTON_SIZES[this.getSize()]:""},updateButtons:function(){return this.isRealized()&&(0===this.getButtons().length?this.getModalFooter().hide():this.getModalFooter().show().find("."+this.getNamespace("footer")).html("").append(this.createFooterButtons())),this},isAutodestroy:function(){return this.options.autodestroy},setAutodestroy:function(a){this.options.autodestroy=a},getDescription:function(){return this.options.description},setDescription:function(a){return this.options.description=a,this},setTabindex:function(a){return this.options.tabindex=a,this},getTabindex:function(){return this.options.tabindex},updateTabindex:function(){return this.isRealized()&&this.getModal().attr("tabindex",this.getTabindex()),this},getDefaultText:function(){return d.DEFAULT_TEXTS[this.getType()]},getNamespace:function(a){return d.NAMESPACE+"-"+a},createHeaderContent:function(){var b=a("<div></div>");return b.addClass(this.getNamespace("header")),b.append(this.createTitleContent()),b.prepend(this.createCloseButton()),b},createTitleContent:function(){var b=a("<div></div>");return b.addClass(this.getNamespace("title")),b},createCloseButton:function(){var b=a("<div></div>");b.addClass(this.getNamespace("close-button"));var c=a('<button class="close" aria-label="close"></button>');return c.append(this.options.closeIcon),b.append(c),b.on("click",{dialog:this},function(a){a.data.dialog.close()}),b},createBodyContent:function(){var b=a("<div></div>");return b.addClass(this.getNamespace("body")),b.append(this.createMessageContent()),b},createMessageContent:function(){var b=a("<div></div>");return b.addClass(this.getNamespace("message")),b},createFooterContent:function(){var b=a("<div></div>");return b.addClass(this.getNamespace("footer")),b},createFooterButtons:function(){var b=this,c=a("<div></div>");return c.addClass(this.getNamespace("footer-buttons")),this.indexedButtons={},a.each(this.options.buttons,function(a,e){e.id||(e.id=d.newGuid());var f=b.createButton(e);b.indexedButtons[e.id]=f,c.append(f)}),c},createButton:function(b){var c=a('<button class="btn"></button>');return c.prop("id",b.id),c.data("button",b),"undefined"!=typeof b.icon&&""!==a.trim(b.icon)&&c.append(this.createButtonIcon(b.icon)),"undefined"!=typeof b.label&&c.append(b.label),"undefined"!=typeof b.title&&c.attr("title",b.title),c.addClass("undefined"!=typeof b.cssClass&&""!==a.trim(b.cssClass)?b.cssClass:"btn-default"),"object"==typeof b.data&&b.data.constructor==={}.constructor&&a.each(b.data,function(a,b){c.attr("data-"+a,b)}),"undefined"!=typeof b.hotkey&&(this.registeredButtonHotkeys[b.hotkey]=c),c.on("click",{dialog:this,$button:c,button:b},function(a){var b=a.data.dialog,c=a.data.$button,d=c.data("button");return d.autospin&&c.toggleSpin(!0),"function"==typeof d.action?d.action.call(c,b,a):void 0}),this.enhanceButton(c),"undefined"!=typeof b.enabled&&c.toggleEnable(b.enabled),c},enhanceButton:function(a){return a.dialog=this,a.toggleEnable=function(a){var b=this;return"undefined"!=typeof a?b.prop("disabled",!a).toggleClass("disabled",!a):b.prop("disabled",!b.prop("disabled")),b},a.enable=function(){var a=this;return a.toggleEnable(!0),a},a.disable=function(){var a=this;return a.toggleEnable(!1),a},a.toggleSpin=function(b){var c=this,d=c.dialog,e=c.find("."+d.getNamespace("button-icon"));return"undefined"==typeof b&&(b=!(a.find(".icon-spin").length>0)),b?(e.hide(),a.prepend(d.createButtonIcon(d.getSpinicon()).addClass("icon-spin"))):(e.show(),a.find(".icon-spin").remove()),c},a.spin=function(){var a=this;return a.toggleSpin(!0),a},a.stopSpin=function(){var a=this;return a.toggleSpin(!1),a},this},createButtonIcon:function(b){var c=a("<span></span>");return c.addClass(this.getNamespace("button-icon")).addClass(b),c},enableButtons:function(b){return a.each(this.indexedButtons,function(a,c){c.toggleEnable(b)}),this},updateClosable:function(){return this.isRealized()&&this.getModalHeader().find("."+this.getNamespace("close-button")).toggle(this.isClosable()),this},onShow:function(a){return this.options.onshow=a,this},onShown:function(a){return this.options.onshown=a,this},onHide:function(a){return this.options.onhide=a,this},onHidden:function(a){return this.options.onhidden=a,this},isRealized:function(){return this.realized},setRealized:function(a){return this.realized=a,this},isOpened:function(){return this.opened},setOpened:function(a){return this.opened=a,this},handleModalEvents:function(){return this.getModal().on("show.bs.modal",{dialog:this},function(a){var b=a.data.dialog;if(b.setOpened(!0),b.isModalEvent(a)&&"function"==typeof b.options.onshow){var c=b.options.onshow(b);return c===!1&&b.setOpened(!1),c}}),this.getModal().on("shown.bs.modal",{dialog:this},function(a){var b=a.data.dialog;b.isModalEvent(a)&&"function"==typeof b.options.onshown&&b.options.onshown(b)}),this.getModal().on("hide.bs.modal",{dialog:this},function(a){var b=a.data.dialog;if(b.setOpened(!1),b.isModalEvent(a)&&"function"==typeof b.options.onhide){var c=b.options.onhide(b);return c===!1&&b.setOpened(!0),c}}),this.getModal().on("hidden.bs.modal",{dialog:this},function(b){var c=b.data.dialog;c.isModalEvent(b)&&"function"==typeof c.options.onhidden&&c.options.onhidden(c),c.isAutodestroy()&&(c.setRealized(!1),delete d.dialogs[c.getId()],a(this).remove()),d.moveFocus(),a(".modal").hasClass("in")&&a("body").addClass("modal-open")}),this.handleModalBackdropEvent(),this.getModal().on("keyup",{dialog:this},function(a){27===a.which&&a.data.dialog.isClosable()&&a.data.dialog.canCloseByKeyboard()&&a.data.dialog.close()}),this.getModal().on("keyup",{dialog:this},function(b){var c=b.data.dialog;if("undefined"!=typeof c.registeredButtonHotkeys[b.which]){var d=a(c.registeredButtonHotkeys[b.which]);!d.prop("disabled")&&d.focus().trigger("click")}}),this},handleModalBackdropEvent:function(){return this.getModal().on("click",{dialog:this},function(b){a(b.target).hasClass("modal-backdrop")&&b.data.dialog.isClosable()&&b.data.dialog.canCloseByBackdrop()&&b.data.dialog.close()}),this},isModalEvent:function(a){return"undefined"!=typeof a.namespace&&"bs.modal"===a.namespace},makeModalDraggable:function(){return this.options.draggable&&(this.getModalHeader().addClass(this.getNamespace("draggable")).on("mousedown",{dialog:this},function(a){var b=a.data.dialog;b.draggableData.isMouseDown=!0;var c=b.getModalDialog().offset();b.draggableData.mouseOffset={top:a.clientY-c.top,left:a.clientX-c.left}}),this.getModal().on("mouseup mouseleave",{dialog:this},function(a){a.data.dialog.draggableData.isMouseDown=!1}),a("body").on("mousemove",{dialog:this},function(a){var b=a.data.dialog;b.draggableData.isMouseDown&&b.getModalDialog().offset({top:a.clientY-b.draggableData.mouseOffset.top,left:a.clientX-b.draggableData.mouseOffset.left})})),this},realize:function(){return this.initModalStuff(),this.getModal().addClass(d.NAMESPACE).addClass(this.getCssClass()),this.updateSize(),this.getDescription()&&this.getModal().attr("aria-describedby",this.getDescription()),this.getModalFooter().append(this.createFooterContent()),this.getModalHeader().append(this.createHeaderContent()),this.getModalBody().append(this.createBodyContent()),this.getModal().data("bs.modal",new c(this.getModal(),{backdrop:"static",keyboard:!1,show:!1})),this.makeModalDraggable(),this.handleModalEvents(),this.setRealized(!0),this.updateButtons(),this.updateType(),this.updateTitle(),this.updateMessage(),this.updateClosable(),this.updateAnimate(),this.updateSize(),this.updateTabindex(),this},open:function(){return!this.isRealized()&&this.realize(),this.getModal().modal("show"),this},close:function(){return!this.isRealized()&&this.realize(),this.getModal().modal("hide"),this}},d.prototype=a.extend(d.prototype,d.METHODS_TO_OVERRIDE[c.getModalVersion()]),d.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},d.show=function(a){return new d(a).open()},d.alert=function(){var b={},c={type:d.TYPE_PRIMARY,title:null,message:null,closable:!1,draggable:!1,buttonLabel:d.DEFAULT_TEXTS.OK,buttonHotkey:null,callback:null};b="object"==typeof arguments[0]&&arguments[0].constructor==={}.constructor?a.extend(!0,c,arguments[0]):a.extend(!0,c,{message:arguments[0],callback:"undefined"!=typeof arguments[1]?arguments[1]:null});var e=new d(b);return e.setData("callback",b.callback),e.addButton({label:b.buttonLabel,hotkey:b.buttonHotkey,action:function(a){return"function"==typeof a.getData("callback")&&a.getData("callback").call(this,!0)===!1?!1:(a.setData("btnClicked",!0),a.close())}}),e.onHide("function"==typeof e.options.onhide?function(a){var b=!0;return!a.getData("btnClicked")&&a.isClosable()&&"function"==typeof a.getData("callback")&&(b=a.getData("callback")(!1)),b===!1?!1:b=this.onhide(a)}.bind({onhide:e.options.onhide}):function(a){var b=!0;return!a.getData("btnClicked")&&a.isClosable()&&"function"==typeof a.getData("callback")&&(b=a.getData("callback")(!1)),b}),e.open()},d.confirm=function(){var b={},c={type:d.TYPE_PRIMARY,title:null,message:null,closable:!1,draggable:!1,btnCancelLabel:d.DEFAULT_TEXTS.CANCEL,btnCancelClass:null,btnCancelHotkey:null,btnOKLabel:d.DEFAULT_TEXTS.OK,btnOKClass:null,btnOKHotkey:null,btnsOrder:d.defaultOptions.btnsOrder,callback:null};b="object"==typeof arguments[0]&&arguments[0].constructor==={}.constructor?a.extend(!0,c,arguments[0]):a.extend(!0,c,{
message:arguments[0],callback:"undefined"!=typeof arguments[1]?arguments[1]:null}),null===b.btnOKClass&&(b.btnOKClass=["btn",b.type.split("-")[1]].join("-"));var e=new d(b);e.setData("callback",b.callback);var f=[{label:b.btnCancelLabel,cssClass:b.btnCancelClass,hotkey:b.btnCancelHotkey,action:function(a){return"function"==typeof a.getData("callback")&&a.getData("callback").call(this,!1)===!1?!1:a.close()}},{label:b.btnOKLabel,cssClass:b.btnOKClass,hotkey:b.btnOKHotkey,action:function(a){return"function"==typeof a.getData("callback")&&a.getData("callback").call(this,!0)===!1?!1:a.close()}}];return b.btnsOrder===d.BUTTONS_ORDER_OK_CANCEL&&f.reverse(),e.addButtons(f),e.open()},d.warning=function(a,b){return new d({type:d.TYPE_WARNING,message:a}).open()},d.danger=function(a,b){return new d({type:d.TYPE_DANGER,message:a}).open()},d.success=function(a,b){return new d({type:d.TYPE_SUCCESS,message:a}).open()},d});