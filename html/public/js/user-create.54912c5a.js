jQuery(document).ready(function($){function getHierarchy(){var a=getCurrentRegionHierarchy(),b=a.id,c=a.name;null!=b&&con(b,c)}function getPanel(location){$.get("/control/"+location+"/jcontrollist/"+withChildren,function(data){var dataNow=$.grep(data,function(a){return void 0===a.integraStatusList||void 0===a.integraStatusList[6]?!1:a.integraStatusList[6].status>1});dataNow=$.map(dataNow,function(a){return a.text=a.text||a.name,a}),$("#integraIdList").empty(),$("#integraIdList").select2({multiple:!0,data:dataNow}),$("#integraIdList").val(eval($("#integraIdListOld").val())).trigger("change")},"json")}function con(a,b){$("#message-tree").text(b),$("#message-tree").val(b),$("#hierarchyId").text(a),$("#hierarchyId").val(a),getPanel(a)}function activateSave(){var a;a=""!==$("#input-name").val()?!0:!1;var b=$("#input-integraDefName").val().length;if(b>0?($("#input-code").addClass("required"),$("#input-code").prop("disabled",!1),$("#permissionProfileId option").length>1&&($("#permissionProfileId").prop("disabled",!1),"0"!==$("#permissionProfileId").val()&&null!==$("#integraIdList").val()||0!==$("#input-integraDefName").val().length&&0!==$("#input-code").val().length&&null==$("#integraIdList").val()?a&=!0:a=!1)):($("#input-code").removeClass("required"),$("#input-code").prop("disabled",!0),$("#integraIdList").prop("disabled",!0),$("#input-code").val(""),a&=!0),$("#permissionProfileId").length>0){var c=$("#permissionProfileId")[0],d=c.selectedIndex?$(c.options[c.selectedIndex]).data("utype"):void 0,e=$("#userCnt").val(),f=$("#userSchema").val();a&="2"!=d&&"3"!=d||void 0!==e&&""!==e?!0:!1,a&="10"!=d||void 0!==e&&""!==e||void 0!==f&&""!==f?!0:!1}$("#user-submit input").prop("disabled",!a)}$(".tree-menu li a")&&$(".tree-menu li a").click(function(){con($(this).data("value"),$(this).text())});var withChildren=getToggleChildrenBool();$(document).on("tree-toggle-recvd",function(a,b){withChildren="1"==b,getHierarchy()}),$(document).on("tree-selected",function(){getHierarchy()}),$("#permissionProfileId").on("change",function(a){var b=$(a.target.options[a.target.selectedIndex]).data("utype");$("#integraIdList").prop("disabled",a.target.selectedIndex<0),"2"==b||"3"==b?($("#userCntSection").show(),$("#userCnt").prop("min",1),$("#userCnt").prop("max",255),$("#userSchemaSection").hide()):"10"==b?($("#userCntSection").show(),$("#userCnt").prop("min",0),$("#userCnt").prop("max",254),$("#userSchemaSection").show()):($("#userSchemaSection").hide(),$("#userCntSection").hide(),$("#userCnt").val(""),$("#userSchema").val("")),void 0===b||""===b?$("#panelSection").hide():$("#panelSection").show(),activateSave()}),$("#integraIdList").on("change",function(){activateSave()});var clickCount=0;$(document).on("select2:opening","#integraIdList",$.proxy(function(){$("#integraIdList").data("open")===!1?($("#integraIdList").data("open",!0),++clickCount%2===0&&$(document).mouseup($.proxy(function(){return getHierarchy(),$(document).unbind("mouseup"),setTimeout($.proxy(function(){$("#integraIdList").data("open",!1)},this),1),!1},this))):$("#integraIdList").data("open",!1)},this)),$("#permissionProfileId").on("change",function(){activateSave()}),$("#input-name").focusin(function(a){""===a.target.value&&(a.target.value=($("#input-surname").val()+" "+$("#input-forename").val()).trim(),activateSave())}),$("#input-name").keyup(function(){activateSave()}),$("#input-integraDefName").focusin(function(a){""===a.target.value&&(a.target.value=$("#input-name").val().trim().substr(0,16)),activateSave()}),$("#userCnt, #userSchema, #input-integraDefName").on("focusout keyup input",function(){activateSave()}),$("#input-code").keyup(function(){activateSave()}),$("#locationOpen").click(function(){$("#tree-toggle").click()}),getHierarchy()}),jQuery(document).ready(function(a){function b(b){if(!window.FileReader)return void alert("The file API isn't supported on this browser yet.");if(b.files&&b.files[0]){var c=b.files[0],d=new FileReader;d.onload=function(b){a("#img").attr("src",b.target.result),a("#photo").attr("value",b.target.result)},c.size<=1048576?d.readAsDataURL(c):(b.value="",BootstrapDialog.show({type:BootstrapDialog.TYPE_DANGER,message:a("#trans-file-too-big").val(),buttons:[{label:"OK",action:function(a){a.close()}}]}))}else b.files||alert("This browser doesn't seem to support the `files` property of file inputs.")}a("#asd").change(function(){b(this)})});