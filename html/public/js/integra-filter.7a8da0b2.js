jQuery(document).ready(function(a){function b(){var a=getCurrentRegionHierarchy(),b=a.id,d=a.name;null!=b&&c(b,d)}function c(b){a("#hierarchytree").text(b),a("#hierarchytree").val(b),document.getElementById("btnFilter").disabled=!1,a("#form-filter-setting").trigger("submit")}function d(){var b={hierarchytree:a("#hierarchytree").val(),integra:a("#integra").val(),ip:a("#ip").val(),statusCode:a("#statusCode").val(),withChildren:i>0?!0:!1};a("#integra-list-getcsv").attr("value",JSON.stringify(b))}function e(){a("form.ajax").on("submit",function(){var b=a(this).parents("tr"),c=a(this),d=c.attr("id");return c.find("[type=submit]").attr("disabled","disabled"),a.ajax({url:c.prop("action"),data:c.serialize(),method:"post",dataType:"json",formname:d,form:c,row:b}).done(function(c){if(this.form.parents(".modal").modal("hide"),this.form.find("[type=submit]").removeAttr("disabled"),1==c.status){if(1>this.row.length){var d=a("#"+this.formname+" input[name=idIntegra]").val();"form-controlDestroy"===this.formname&&a("#integraTr-"+d).hide()}b.attr("class",""),b.addClass(c.alert)}SatelMessageDialog.show({alert:c.alert,message:c.message,messageDetail:c.messageDetail})}).fail(function(){window.location.href="/logout"}),!1})}function f(b,c){a(".filter a").removeClass(k),a("#statusCode").attr("value")===b||0===b?a("#statusCode").attr("value","0"):(a("#statusCode").attr("value",b),c.addClass(k)),a("#form-filter-setting").submit()}function g(b,c){b.find("#nameIntegra").empty(),b.find("#nameIntegra").append(a(c.relatedTarget).data("name")),b.find("#idIntegra").attr("value",a(c.relatedTarget).data("value"))}var h=a('input[name="trans-date-picker-FormatSec"]').val(),i=getToggleChildrenValue();window.Pace.options.ajax=a.extend(window.Pace.options.ajax,{trackMethods:["GET","POST"]}),a(document).on("tree-toggle-recvd",function(b,c){i=1==c,a("#form-filter-setting").submit()}),a(function(){a('[data-toggle="tooltip"]').tooltip()});var j=a("#idSpinner").hide();a(document).on("tree-selected",function(){b()}),a("#btn-filter-clear").click(function(){a("input#integra").val(""),a("input#ip").val(""),f(0,void 0),a("#form-filter-setting").submit(),a("#integra").focus()}),a("#refreshDateBtn").click(function(){a("#form-filter-setting").submit()}),a("#form-filter-setting").on("submit",function(){a("#integraTable").hide();var b=moment().format(h);return j.show(),d(),a.post(a(this).prop("action"),{_token:a(this).find("input[name=_token]").val(),hierarchytree:a("#hierarchytree").val(),integra:a("#integra").val(),ip:a("#ip").val(),statusCode:a("#statusCode").val(),withChildren:1==i},function(c){a("#refreshDateTxt").html(b),a("#integraTable").empty();var d={1:"",2:"outlined",3:"blink"},f={0:"yellow",1:"red",2:"red outlined",3:"green blink"};a(c).each(function(b,c){var e="No ETHM";c.ip&&(e=c.ip+":"+c.port),a("#integraTable").append('<tr ng-repeat="panel in integrum.panels" id="integraTr-'+c.id+'"><td> </td><td></td>\n                                            <td><a href="/control/structure/'+c.id+'">'+c.name+"</a></td><td>"+e+"</td>\n                                            <td><a class='diodes' href='/event/#{\"panel\":"+c.id+',"source":[0,1]}\'><div class="diode red '+d[c.statusCode[0].status]+"\"></div></a></td>\n                                            <td><a class='diodes' href='/event/#{\"panel\":"+c.id+',"source":[5]}\'><div class="diode yellow '+d[c.statusCode[1].status]+"\"></div></a></td>\n                                            <td><a class='diodes' href='/event/#{\"panel\":"+c.id+',"source":[2]}\'><div class="diode green '+d[c.statusCode[2].status]+"\"></div></a></td>\n                                            <td><a class='diodes' href='/event/#{\"panel\":"+c.id+',"source":[7]}\'><div class="diode green2 '+d[c.statusCode[3].status]+"\"></div></a></td>\n                                            <td><a class='diodes' href='/event/#{\"panel\":"+c.id+',"source":[130]}\'><div class="diode '+f[c.statusCode[6].status]+'"></td><td></td><td class="actionColumn">'+c.action+"</a></td><td></td></tr>")}),a("#integraTable").show(),j.hide(),e()},"json"),!1});var k="btn-warning btn-xs";a(".filter a").click(function(){var b=a(this).attr("href").split("#")[1];f(b,a(this))}),a("#controlDestroy, #controlArm, #controlDisarm").on("shown.bs.modal",function(b){g(a(this),b)}),a("#event-export").click(function(){a("#form-csv").submit()}),b()});